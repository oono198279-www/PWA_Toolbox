<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>PWA ğŸ§° Toolbox</title>
<link rel="manifest" href="manifest.webmanifest">
<meta name="theme-color" content="#0a84ff">
<link rel="apple-touch-icon" href="icons/icon-192.png">

<style>
  :root{
    --bg:#f6f7fb; --card:#fff; --ink:#1f2937; --sub:#6b7280;
    --theme:#0a84ff; --radius:14px; --shadow:0 6px 20px rgba(0,0,0,.08)
  }
  html,body{margin:0;background:var(--bg);color:var(--ink);
    font-family:system-ui,-apple-system,Segoe UI,Roboto,'Hiragino Kaku Gothic ProN',Meiryo,sans-serif;}

  /* â–¼ èµ·å‹•ç”»é¢ â–¼ */
  #splash{
    position:fixed;inset:0;display:grid;place-items:center;
    background:linear-gradient(180deg,#f3f8ff 0%,#e8f0ff 100%);
    transition:opacity .5s ease;z-index:999;
  }
  #splash.hide{opacity:0;pointer-events:none;}
  #splash .box{display:flex;flex-direction:column;align-items:center}
  #splash img{
    width:min(26vh,160px); height:min(26vh,160px);
    display:block; object-fit:contain;
    /* ç”»åƒã«ä½™ç™½ãŒå…¥ã£ã¦ã„ã¦ã‚‚ä¸­å¤®ã«è¦‹ãˆã‚‹ã‚ˆã†ã«å½±ä»˜ãã§è¦–èªæ€§UPï¼ˆä»»æ„ï¼‰ */
    filter: drop-shadow(0 2px 6px rgba(0,0,0,.15));
    margin-bottom:12px;
  }
  #splash p{font-size:20px;font-weight:bold;color:#334155;margin:0;}
  
  /* â–¼ æœ¬ä½“ â–¼ */
  header{position:sticky;top:0;background:linear-gradient(#fff,rgba(255,255,255,.7));
    backdrop-filter:saturate(180%) blur(8px);padding:16px 20px;border-bottom:1px solid #eee;z-index:10}
  h1{margin:0;font-size:20px;letter-spacing:.02em}
  main{padding:18px}
  .grid{display:grid;gap:14px;grid-template-columns:repeat(auto-fill,minmax(260px,1fr))}
  .card{background:var(--card);border-radius:var(--radius);box-shadow:var(--shadow);overflow:hidden}
  .head{display:flex;align-items:center;gap:14px;padding:14px 16px;cursor:pointer;width:100%;
    background:none;border:0;text-align:left}
  .icon{width:56px;height:56px;border-radius:12px;background:#f0f3f8;display:grid;place-items:center;
    font-size:30px;overflow:hidden;flex:0 0 auto}
  .icon img{width:100%;height:100%;object-fit:cover}
  .title{font-weight:700}
  .tagline{color:var(--sub);font-size:13px;margin-top:2px}
  .body{padding:0 16px 16px;border-top:1px solid #f1f1f1;display:none}
  .desc{color:#374151;line-height:1.6;white-space:pre-wrap;margin-top:10px}
  .actions{display:flex;gap:10px;margin-top:14px;flex-wrap:wrap}
  .btn{appearance:none;border:0;border-radius:10px;padding:10px 14px;font-weight:700;text-decoration:none;display:inline-block}
  .btn.primary{background:var(--theme);color:#fff}
  .btn.ghost{background:#eef3ff;color:#0a4b9f}
  .open .body{display:block}
</style>
</head>
<body>
  <!-- èµ·å‹•ç”»é¢ -->
  <div id="splash">
    <div class="box">
      <img src="icons/icon-192.png" alt="logo">
      <p>PWA ğŸ§° Toolbox</p>
    </div>
  </div>

  <!-- æœ¬ä½“ -->
  <header><h1>PWA ğŸ§° Toolbox</h1></header>
  <main><section class="grid" id="grid"></section></main>

  <script type="application/json" id="apps-fallback">[]</script>

<script>
  (async function(){
    const grid = document.getElementById('grid');
    const hideSplash = ()=>document.getElementById('splash')?.classList.add('hide');
  
    // â˜… ãƒ•ã‚§ãƒ¼ãƒ«ã‚»ãƒ¼ãƒ•ï¼šæœ€å¤§2.2ç§’ã§å¿…ãšéš ã™
    setTimeout(hideSplash, 2200);
    // DOMèª­ã¿è¾¼ã¿ã§ã‚‚éš ã™ï¼ˆç”»åƒèª­ã¿è¾¼ã¿å¾…ã¡ã‚’å›é¿ï¼‰
    document.addEventListener('DOMContentLoaded', hideSplash);
    // å¾“æ¥ã©ãŠã‚Š load ã§ã‚‚éš ã™
    window.addEventListener('load', hideSplash);
  
    // ...ï¼ˆapps.jsonã®èª­ã¿è¾¼ã¿ã¨ã‚«ãƒ¼ãƒ‰æç”»ã¯ä»Šã¾ã§ã©ãŠã‚Šï¼‰...
  
    if('serviceWorker' in navigator){
      navigator.serviceWorker.register('./sw.js').catch(()=>{});
    }
  })();
  
  // èµ·å‹•ç”»é¢ï¼šèª­ã¿è¾¼ã¿å¾Œ1.5ç§’ã§ãƒ•ã‚§ãƒ¼ãƒ‰ã‚¢ã‚¦ãƒˆ
  window.addEventListener('load',()=>{
    setTimeout(()=>document.getElementById('splash').classList.add('hide'),1500);
  });

  function renderCard(app){
    const card=document.createElement('article');card.className='card';
    const head=document.createElement('button');head.className='head';
    head.innerHTML=`
      <div class="icon">${iconHTML(app.icon)}</div>
      <div><div class="title">${esc(app.name)}</div><div class="tagline">${esc(app.tagline||'')}</div></div>`;
    const body=document.createElement('div');body.className='body';
    body.innerHTML=`
      <div class="desc">${esc(app.description||'')}</div>
      <div class="actions">
        <a class="btn primary" href="${app.url}" target="_blank" rel="noopener">é–‹ã</a>
        <button class="btn ghost" type="button">ãƒªãƒ³ã‚¯</button>
      </div>`;
    head.onclick=()=>card.classList.toggle('open');
    body.querySelector('.btn.ghost').onclick=async()=>{
      try{await navigator.clipboard.writeText(app.url);alert('URLã‚’ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ');}
      catch{prompt('ã‚³ãƒ”ãƒ¼ã§ããªã„ç’°å¢ƒã§ã™ã€‚æ‰‹å‹•ã§ã‚³ãƒ”ãƒ¼ã—ã¦ãã ã•ã„ï¼š',app.url);}
    };
    card.append(head,body);
    return card;
  }
  function iconHTML(src){return(/^https?:|^\.{0,2}\//.test(src))?`<img alt="" src="${esc(src)}">`:esc(src||'ğŸ§©');}
  function esc(s){return String(s).replace(/[&<>"']/g,m=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;'}[m]));}

  if('serviceWorker' in navigator){
    navigator.serviceWorker.register('./sw.js').catch(()=>{});
  }
})();
</script>
</body>
</html>